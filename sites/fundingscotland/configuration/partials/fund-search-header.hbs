<div class="banner-search overlay">
  <div class="content page-content">
    <div class="overlay-content">
      <div class="mdc-layout-grid">
        <div class="mdc-layout-grid__inner">
          <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-8-tablet mdc-layout-grid__cell--span-4-phone">
            <p class="header-extra">
              Find funds for your organisation
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="search-content">
      <form id="search-view" class="search-form mdc-elevation--z5" action="/search" method="GET">
        <div class="mdc-layout-grid">
          <div class="mdc-layout-grid__inner">
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-10-desktop mdc-layout-grid__cell--span-7-tablet mdc-layout-grid__cell--span-4-phone">
              <div class="header mdc-text-field mdc-text-field--box mdc-text-field--with-leading-icon mdc-text-field-tt" data-mdc-auto-init="MDCTextField">
                <span class="far fa-search mdc-text-field__icon" tabindex="0" role="button"></span>
                <input type="text" id="what-primary-content" name="keywords" class="mdc-text-field__input" placeholder="" data-lpignore="true" data-typeahead='{
                  "typeaheadOptions": {
                    "highlight": true,
                    "minlength": 0
                  },
                  "outputs": [
                    {
                      "type": "element",
                      "options": {
                        "containerSelectorTemplate": "#search-terms",
                        "testSelectorTemplate": "#\{{dataset.name}}-\{{item.value}}",
                        "removeSelectorTemplate": "#remove-\{{dataset.name}}-\{{item.value}}",
                        "template": {{#blockStringify this~}}
                          <div class="mdc-chip mdc-theme--primary-bg" tabindex="0" id="\{{dataset.name}}-\{{item.value}}">
                            <div class="mdc-chip__text">\{{item.label}}</div>
                            <input type="hidden" name="\{{dataset.name}}[]" value="\{{item.value}}">
                            <i class="far fa-times-circle mdc-chip__icon mdc-chip__icon--trailing" tabindex="0" role="button" id="remove-\{{dataset.name}}-\{{item.value}}"></i>
                          </div>
                        {{~/blockStringify}}
                      }
                    },
                    {
                      "type": "prop",
                      "options": {
                        "selectorTemplate": "[name=\"\{{value}}\"]"
                      }
                    }
                  ],
                  "datasets": [
                    {{#each @root.context.metaData.terms}}
                      {{#each termGroups}}
                        {
                          "name": {{{stringify @../key}}},
                          "templates": {
                            {{#compare (length (getKeys ../termGroups)) 1}}
                              "header": "<h3>{{{../label}}}</h3>"
                            {{else}}
                              "header": "<h3>{{{../label}}} &gt; {{{label}}}</h3>"
                            {{/compare}}
                          },
                          "display": "label",
                          "items": [
                            {{#each terms}}
                            {
                            "label": {{{stringify this}}},
                            "value": {{{stringify @key}}}
                            }{{#unless @last}},{{/unless}}
                            {{/each}}
                          ]
                        }{{#unlessAll @last @../last}},{{/unlessAll}}
                      {{/each}}
                    {{/each}}
                  ]
                }'>
                <label for="what-primary-content" class="mdc-floating-label">
                  Keywords
                </label>
                <div class="mdc-line-ripple"></div>
              </div>
            </div>
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-2-desktop mdc-layout-grid__cell--span-1-tablet mdc-layout-grid__cell--span-4-phone">
              <button type="submit" id="search-funds" class="mdc-button mdc-button--raised mdc-text-field--box mdc-button--search mdc-ripple-surface mdc-ripple-surface--primary" data-mdc-auto-init="MDCRipple">
                Search
                <span class="far fa-search" aria-hidden="true"></span>
              </button>
            </div>
          </div>
          <div class="mdc-layout-grid__inner">
            <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-7-tablet mdc-layout-grid__cell--span-4-phone">
              <div id="search-terms" class="mdc-chip-set"></div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

{{#compare @root.data.primaryResponse.hits.total ">" 0}}
<div class="mdc-layout-grid home-heading">
  <div class="mdc-layout-grid__inner">
    <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-8-tablet mdc-layout-grid__cell--span-4-phone">
      {{#compare @root.data.primaryResponse.hits.total ">" 0}}
      <h2 class="mdc-typography--headline5">
        Your latest funds&ensp;
        <span class="mdc-typography--body1">
          <a href="/searches">Your searches</a>
        </span>
      </h2>
      {{else}}
      <div class="mdc-typography--headline5">
        Latest funds&ensp;
        <span class="mdc-typography--body1">
          <a href="/search?sort=newest&page=2">Find more</a>
        </span>
      </div>
      {{/compare}}
    </div>
  </div>
</div>
<div class="home-content-primary">
  {{#>components_horizontal_card_scroller
      outerClasses="home-latest"
      scrollLeftIconClasses="fal fa-fw fa-angle-left"
      scrollRightIconClasses="fal fa-fw fa-angle-right"
      itemClasses="latest-primary-content latest-primary-content-personalised"
      items=(if (any @root.data.primaryResponse.hits.hits)
        (map @root.data.primaryResponse.hits.hits (getProp "_source"))
        else=(map @root.data.primaryResponse.hits.hits (getProp "_source"))
      )
      itemsPartial="fund_mini"
      moreUrl=(if
        (compare @root.data.primaryResponse.hits.total ">" 0)
        "/search?sort=newest"
        else="/search?sort=newest&page=2"
      )
      moreText=(if
        (compare @root.data.primaryResponse.hits.total ">" 0)
        "All latest jobs"
        else="Find more jobs"
      )}}
    {{/components_horizontal_card_scroller}}
  </div>
</div>
{{/compare}}