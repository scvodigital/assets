{
  "size": 4,
  "_source": [
    "slug",
    "title",
    "rendered.scvo_gist"
  ],
  "query": {
    "function_score": {
      "query": {
        "bool": {
          "must_not": [
            {
              "term": {
                "hide_in_results": true
              }
            },
            {
              "term": {
                "hide_from_search": "1"
              }
            }
          ],
          "must": [
            {
              "term": {
                "is_press_release": false
              }
            }
          ]
        }
      },
      "functions": [
        {
          "filter": {
            "more_like_this" : {
              "fields" : ["text_bag"],
              "like" : "{{@root.data.primaryResponse.hits.hits.[0]._source.text_bag_boost}}",
              "min_term_freq" : 1,
              "max_query_terms" : 12
            }
          },
          "random_score": {},
          "weight": 5
        },
        {
          "filter": {
            "terms": {
              "categories_id": [
                {{join @root.data.primaryResponse.hits.hits.[0]._source.categories_id}}
              ]
            }
          },
          "weight": 4
        },
        {
          "filter": {
            "term": {
              "_type": "scvo-cms-post"
            }
          },
          "weight": 1,
          "gauss": {
            "publish_on": {
              "scale": "30d",
              "decay": 0.25
            }
          }
        }
      ],
      "score_mode": "sum"
    }
  }
}